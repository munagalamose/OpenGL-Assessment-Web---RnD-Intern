<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Edge Viewer Web</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 0; padding: 24px; background: #0f1115; color: #e6e6e6; }
    header { margin-bottom: 16px; }
    .stats { font-size: 14px; color: #a8b3cf; margin: 8px 0; }
    .frame { display: block; max-width: 100%; border-radius: 8px; border: 1px solid #2a2f3a; margin-top: 12px; }
    .container { max-width: 880px; margin: 0 auto; }
    .row { display: flex; gap: 24px; align-items: flex-start; flex-wrap: wrap; }
    .col { flex: 1 1 320px; }
    code { background: #161a22; padding: 2px 6px; border-radius: 4px; }
    input[type="file"] { margin-top: 12px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Edge Viewer (Web)</h1>
      <p class="stats">FPS: <span id="fps">--</span> | Resolution: <span id="res">--</span></p>
    </header>

    <div class="row">
      <div class="col">
        <img id="frame" class="frame" alt="Processed frame" />
        <input type="file" id="upload" accept=".txt,.png,.jpg,.jpeg" />
      </div>
      <div class="col">
        <p>Displays a sample processed frame (base64) exported from the Android pipeline.</p>
        <p>If Node/Vite is unavailable, this page still works standalone. Update the image via <code>window.sampleFrame</code>.</p>
        <pre><code>window.sampleFrame = "data:image/png;base64,..."</code></pre>
      </div>
    </div>
  </div>

  <script>
    const frameImg = document.getElementById("frame");
    const fpsEl = document.getElementById("fps");
    const resEl = document.getElementById("res");
    const uploadInput = document.getElementById("upload");

    // === Default sample frame (tiny placeholder) ===
    window.sampleFrame = window.sampleFrame || 
      'data:image/svg+xml;base64,' + btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="640" height="360">
        <rect width="100%" height="100%" fill="#111"/>
        <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle"
              fill="#e6e6e6" font-family="Arial" font-size="20">Sample processed frame</text>
      </svg>`);

    // Load default frame
    frameImg.src = window.sampleFrame;

    // Update stats when image loads
    frameImg.onload = () => {
      fpsEl.textContent = "30"; // demo FPS
      resEl.textContent = `${frameImg.naturalWidth}x${frameImg.naturalHeight}`;
    };

    // === Handle file upload ===
    uploadInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      if (file.name.endsWith(".txt")) {
        // Base64 text file
        reader.onload = () => {
          frameImg.src = "data:image/png;base64," + reader.result.trim();
        };
        reader.readAsText(file);
      } else if (file.type.startsWith("image/")) {
        // Image file (png, jpg)
        reader.onload = () => {
          frameImg.src = reader.result;
        };
        reader.readAsDataURL(file);
      }
    });
  </script>
</body>
</html>
